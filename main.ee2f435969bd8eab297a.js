(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function o(t,e,o){return(e=r(e))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function r(e){var o=function(e,o){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(o)?o:String(o)}var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,"PLAYFIELD_COLUMNS",10),o(this,"PLAYFIELD_ROWS",20),o(this,"TETROMINO_EASY",["DOT","DABBLE","O","L","RL","T","I","J"]),o(this,"TETROMINO_MIDDLE",["DOT","DABBLE","O","L","RL","T","I","J","S","Z"]),o(this,"TETROMINO_HARD",["DOT","DABBLE","O","L","RL","T","I","J","S","Z","BIGT","X"]),o(this,"TETROMINO_NAMES",this.TETROMINO_EASY),o(this,"TETROMINOES",{DOT:[[1]],DABBLE:[[1,1],[0,0]],O:[[1,1],[1,1]],L:[[0,0,1],[1,1,1],[0,0,0]],RL:[[0,0,0],[1,1,1],[0,0,1]],T:[[1,1,1],[0,1,0],[0,0,0]],I:[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],J:[[1,1,0],[0,1,0],[1,1,0]],S:[[0,1,1],[0,1,0],[1,1,0]],Z:[[1,1,0],[0,1,0],[0,1,1]],BIGT:[[1,1,1],[0,1,0],[0,1,0]],X:[[0,1,0],[1,1,1],[0,1,0]]}),o(this,"playField",void 0),o(this,"gameTetro",void 0),o(this,"tetromino",{}),o(this,"score",0),o(this,"validator",void 0)}var r,i;return r=t,(i=[{key:"getRows",value:function(){return this.PLAYFIELD_ROWS}},{key:"getColumns",value:function(){return this.PLAYFIELD_COLUMNS}},{key:"getPlayField",value:function(){return this.playField}},{key:"getCells",value:function(){return document.querySelectorAll(".tetris div")}},{key:"getTetromino",value:function(){return this.tetromino}},{key:"getGameTetro",value:function(){return this.gameTetro}},{key:"getScore",value:function(){return this.score}},{key:"getValidator",value:function(){return this.validator}},{key:"setPlayField",value:function(t){this.playField=t}},{key:"setTetromino",value:function(t){this.tetromino=t}},{key:"setGameTetro",value:function(t){this.gameTetro=t}},{key:"setScore",value:function(t){this.score=t}},{key:"setValidator",value:function(t){this.validator=t}},{key:"setTetrominoNames",value:function(t){this.TETROMINO_NAMES=t}}])&&e(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),t}();function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function a(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l(r.key),r)}}function l(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:String(e)}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,o;return e=t,(o=[{key:"getIndex",value:function(t,e,o){return t*e+o}}])&&a(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,m(r.key),r)}}function m(t){var e=function(t,e){if("object"!=u(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:String(e)}var f=function(){function t(e){var o,r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,r="tetris",i=document.querySelector(".tetris"),(r=m(r))in o?Object.defineProperty(o,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[r]=i,this.rows=e.getRows(),this.columns=e.getColumns(),this.playField=e.getPlayField(),this.model=e,this.convertorPositionToIndex=new s}var e,o;return e=t,(o=[{key:"reset",value:function(){this.tetris.innerHTML=""}},{key:"generate",value:function(){for(var t=this,e=0;e<this.rows*this.columns;e++){var o=document.createElement("div");this.tetris.append(o)}return this.playField=new Array(this.rows).fill(0).map((function(){return new Array(t.columns).fill(0)})),this.playField}},{key:"draw",value:function(){for(var t=this.model.getCells(),e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++){var r=this.playField[e][o];t[this.convertorPositionToIndex.getIndex(e,this.columns,o)].classList.add(r)}}}])&&c(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function h(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,v(r.key),r)}}function v(t){var e=function(t,e){if("object"!=y(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==y(e)?e:String(e)}var b=function(){function t(e,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.from=e,this.to=o}var e,o;return e=t,(o=[{key:"getRandom",value:function(){return Math.floor(Math.random()*(this.to-this.from)+this.from)}}])&&h(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function p(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,g(r.key),r)}}function g(t){var e=function(t,e){if("object"!=d(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==d(e)?e:String(e)}var w=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.minRange=0,this.maxRange=256}var e,o;return e=t,(o=[{key:"getColor",value:function(){var t=new b(this.minRange,this.maxRange).getRandom(),e=new b(this.minRange,this.maxRange).getRandom(),o=new b(this.minRange,this.maxRange).getRandom();return"rgb(".concat(t,", ").concat(e,", ").concat(o,")")}}])&&p(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function T(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,O(r.key),r)}}function O(t){var e=function(t,e){if("object"!=S(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!=S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==S(e)?e:String(e)}var P=function(){function t(e,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.model=e,this.controller=o,this.convertorPositionToIndex=new s}var e,o;return e=t,(o=[{key:"randomTetromino",value:function(){var t=this.model.TETROMINO_NAMES.length,e=new b(0,t).getRandom();return this.model.TETROMINO_NAMES[e]}},{key:"generate",value:function(){var t=this.randomTetromino(),e=this.model.TETROMINOES[t],o=this.centeringTetromino(this.model.getColumns(),e.length),r=(new w).getColor();return this.model.setTetromino({name:t,matrix:e,row:-2,column:o,color:r})}},{key:"draw",value:function(){for(var t=this.model.getTetromino().name,e=this.model.getTetromino().color,o=this.model.getTetromino().matrix.length,r=this.model.getCells(),i=0;i<o;i++)for(var n=0;n<o;n++)if(0!==this.model.getTetromino().matrix[i][n]&&!(this.model.getTetromino().row+i<0)){var a=this.convertorPositionToIndex.getIndex(this.model.getTetromino().row+i,this.model.getColumns(),this.model.getTetromino().column+n);r[a].classList.add(t),r[a].style.setProperty("--color-tetromino",e)}}},{key:"centeringTetromino",value:function(t,e){return Math.floor((t-e)/2)}},{key:"placeTetromino",value:function(){for(var t=this.model.getTetromino(),e=this.model.getPlayField(),o=t.matrix.length,r=this.model.getValidator(),i=0;i<o;i++)for(var n=0;n<o;n++)if(t.matrix[i][n]){if(r.isOutsideTopBoard(i))return void(this.controller.isGameOver=!0);e[t.row+i][t.column+n]=t.name}this.generate()}}])&&T(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function E(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,R(r.key),r)}}function j(t,e,o){return(e=R(e))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function R(t){var e=function(t,e){if("object"!=k(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!=k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==k(e)?e:String(e)}var F=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),j(this,"tetromino",void 0),j(this,"playField",void 0),this.model=e}var e,o;return e=t,(o=[{key:"isValid",value:function(){this.tetromino=this.model.getTetromino(),this.playField=this.model.getPlayField();for(var t=this.tetromino.matrix.length,e=0;e<t;e++)for(var o=0;o<t;o++)if(this.tetromino.matrix[e][o]){if(this.isOutsideOfGameBoard(e,o,this.tetromino))return!0;if(this.hasCollisions(e,o,this.tetromino))return!0}return!1}},{key:"isOutsideOfGameBoard",value:function(t,e){return this.tetromino.column+e<0||this.tetromino.column+e>=this.model.getColumns()||this.tetromino.row+t>=this.model.getPlayField().length}},{key:"isOutsideTopBoard",value:function(t){return this.tetromino.row+t<0}},{key:"hasCollisions",value:function(t,e){var o;return null===(o=this.playField[this.tetromino.row+t])||void 0===o?void 0:o[this.tetromino.column+e]}}])&&E(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function G(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,C(r.key),r)}}function A(t,e,o){return(e=C(e))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function C(t){var e=function(t,e){if("object"!=I(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!=I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==I(e)?e:String(e)}var L=function(){function t(e,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),A(this,"tetromino",void 0),A(this,"tetro",void 0),this.model=e,this.controller=o,this.validator=new F(this.model)}var e,o;return e=t,(o=[{key:"refreshTetromino",value:function(){this.tetromino=this.model.getTetromino(),this.tetro=this.model.getGameTetro(),this.model.setValidator(this.validator)}},{key:"dropTetrominoDown",value:function(){for(this.refreshTetromino();!this.validator.isValid();)this.tetromino.row++;this.tetromino.row--}},{key:"moveTetrominoDown",value:function(){this.refreshTetromino(),this.tetromino.row+=1,this.validator.isValid()&&(this.tetromino.row-=1,this.tetro.placeTetromino())}},{key:"moveTetrominoLeft",value:function(){this.refreshTetromino(),this.tetromino.column-=1,this.validator.isValid()&&(this.tetromino.column+=1)}},{key:"moveTetrominoRight",value:function(){this.refreshTetromino(),this.tetromino.column+=1,this.validator.isValid()&&(this.tetromino.column-=1)}},{key:"rotateTetromino",value:function(){this.refreshTetromino();var t=this.tetromino.matrix;this.tetromino.matrix=this.rotateMatrix(this.tetromino.matrix),this.validator.isValid()&&(this.tetromino.matrix=t)}},{key:"rotateMatrix",value:function(t){this.refreshTetromino();for(var e=this.tetromino.matrix.length,o=[],r=0;r<e;r++){o[r]=[];for(var i=0;i<e;i++)o[r][i]=t[e-i-1][r]}return o}}])&&G(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function D(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,N(r.key),r)}}function N(t){var e=function(t,e){if("object"!=M(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!=M(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==M(e)?e:String(e)}var x=function(){function t(e,o){var r,i,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=void 0,(i=N(i="gameTetromino"))in r?Object.defineProperty(r,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[i]=n,this.model=e,this.controller=o,this.gameFieldGenerator=new f(this.model),this.controlsTetro=new L(this.model,this.controller),this.gameTetromino=new P(this.model,this.controller,this)}var e,o;return e=t,(o=[{key:"getControlsTetro",value:function(){return this.controlsTetro}},{key:"getGameTetromino",value:function(){return this.gameTetromino}},{key:"getFieldGenerator",value:function(){return this.gameFieldGenerator}},{key:"displayScore",value:function(t,e){document.getElementById("messageAreaScore").innerHTML="Score: ".concat(t,", Next: ").concat(e)}},{key:"draw",value:function(){this.model.getCells().forEach((function(t){t.removeAttribute("class")})),this.gameFieldGenerator.draw(),this.gameTetromino.draw()}}])&&D(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function _(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,V(r.key),r)}}function V(t){var e=function(t,e){if("object"!=B(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!=B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==B(e)?e:String(e)}var q=function(){function t(e,o){var r,i,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=void 0,(i=V(i="score"))in r?Object.defineProperty(r,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[i]=n,this.model=e,this.controller=o}var e,o;return e=t,(o=[{key:"calculate",value:function(t){switch(this.score=this.model.getScore(),t.length){case 1:this.model.setScore(this.score+=10);break;case 2:this.model.setScore(this.score+=30);break;case 3:this.model.setScore(this.score+=50);break;case 4:this.model.setScore(this.score+=100)}this.model.setScore(this.score)}}])&&_(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function H(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,J(r.key),r)}}function J(t){var e=function(t,e){if("object"!=Y(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!=Y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Y(e)?e:String(e)}var K=function(){function t(e,o){var r,i,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=void 0,(i=J(i="playField"))in r?Object.defineProperty(r,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[i]=n,this.model=e,this.controller=o,this.rows=this.model.getRows(),this.columns=this.model.getColumns(),this.scoreCalculator=new q(this.model,this)}var e,o;return e=t,(o=[{key:"find",value:function(){var t=[];this.playField=this.model.getPlayField();for(var e=0;e<this.rows;e++){for(var o=0,r=0;r<this.columns;r++)0!==this.playField[e][r]&&o++;this.columns===o&&t.push(e)}return this.scoreCalculator.calculate(t),this.removeFillRows(t),t}},{key:"removeFillRows",value:function(t){var e=this;t.length<1||t.forEach((function(t){e.dropRowsAbove(t)}))}},{key:"dropRowsAbove",value:function(t){for(var e=t;e>0;e--)this.playField[e]=this.playField[e-1];this.playField[0]=new Array(this.columns).fill(0)}}])&&H(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function Z(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,W(r.key),r)}}function W(t){var e=function(t,e){if("object"!=U(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!=U(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==U(e)?e:String(e)}var X=function(){function t(e,o){var r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(i=W(i="speed"))in r?Object.defineProperty(r,i,{value:800,enumerable:!0,configurable:!0,writable:!0}):r[i]=800,this.model=e,this.controller=o,this.easy=this.model.TETROMINO_EASY,this.middle=this.model.TETROMINO_MIDDLE,this.hard=this.model.TETROMINO_HARD,this.names=this.model.TETROMINO_NAMES}var e,o;return e=t,(o=[{key:"compute",value:function(t,e){switch(t){case 0:this.model.setTetrominoNames(this.easy),this.speed=e;break;case 100:this.model.setTetrominoNames(this.middle),this.speed=700;break;case 140:this.model.setTetrominoNames(this.hard),this.speed=600;break;case 190:this.model.setTetrominoNames(this.hard),this.speed=500}}}])&&Z(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function Q(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tt(r.key),r)}}function $(t,e,o){return(e=tt(e))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function tt(t){var e=function(t,e){if("object"!=z(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!=z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==z(e)?e:String(e)}var et=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),$(this,"gameFieldGenerator",void 0),$(this,"gameField",void 0),$(this,"gameTetromino",void 0),$(this,"timeOutId",void 0),$(this,"requestId",void 0),$(this,"speed",800),$(this,"isPaused",!1),$(this,"isGameOver",!1),$(this,"btnRestart",document.querySelector(".restart")),$(this,"gameOverBlock",document.querySelector(".game-over")),this.model=e,this.view=new x(this.model,this),this.onKeyDown=this.onKeyDown.bind(this),this.down=this.down.bind(this),this.initGame=this.initGame.bind(this),this.controlsTetro=this.view.getControlsTetro(),this.setDifficulties=new X(this.model,this),this.finderFilledRows=new K(this.model,this),this.btnRestart.addEventListener("click",this.initGame)}var e,o;return e=t,(o=[{key:"resetGame",value:function(t){this.model.TETROMINO_NAMES=this.model.TETROMINO_EASY,this.model.setScore(0),this.setDifficulties.compute(this.model.getScore(),this.speed),this.speed=this.setDifficulties.speed,this.gameOverBlock.style.display="none",this.isGameOver=!1,t.reset(),this.model.setPlayField([])}},{key:"initGame",value:function(){this.gameFieldGenerator=this.view.getFieldGenerator(),this.resetGame(this.gameFieldGenerator),this.gameTetromino=this.view.getGameTetromino(),this.gameField=this.gameFieldGenerator.generate(),this.model.setPlayField(this.gameField),this.gameFieldGenerator.draw(),this.gameTetromino.generate(),this.gameTetromino.draw(),this.model.setGameTetro(this.gameTetromino),this.view.displayScore(this.model.getScore()),document.addEventListener("keydown",this.onKeyDown,!1),this.startGame()}},{key:"down",value:function(){this.finderFilledRows.find(),this.view.displayScore(this.model.getScore()),this.setDifficulties.compute(this.model.getScore(),this.speed),this.speed=this.setDifficulties.speed,this.controlsTetro.moveTetrominoDown(),this.view.draw(),this.stopGame(),this.startGame(),this.isGameOver&&this.gameOver()}},{key:"left",value:function(){this.controlsTetro.moveTetrominoLeft()}},{key:"right",value:function(){this.controlsTetro.moveTetrominoRight()}},{key:"rotate",value:function(){this.controlsTetro.rotateTetromino()}},{key:"onKeyDown",value:function(t){if("Enter"===t.key&&this.togglePauseGame(),!this.isPaused){switch(t.key){case"ArrowDown":this.down();break;case"ArrowLeft":this.left();break;case"ArrowRight":this.right();break;case"ArrowUp":this.rotate();break;case" ":this.controlsTetro.dropTetrominoDown()}this.view.draw()}}},{key:"togglePauseGame",value:function(){this.isPaused=!this.isPaused,this.isPaused?this.stopGame():this.startGame()}},{key:"gameOver",value:function(){this.stopGame(),this.gameOverBlock.style.display="flex"}},{key:"startGame",value:function(){var t=this;this.timeOutId=setTimeout((function(){return t.requestId=requestAnimationFrame(t.down)}),this.speed)}},{key:"stopGame",value:function(){cancelAnimationFrame(this.requestId),this.timeOutId=clearTimeout(this.timeOutId)}}])&&Q(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function rt(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,it(r.key),r)}}function it(t){var e=function(t,e){if("object"!=ot(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!=ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ot(e)?e:String(e)}(new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.model=new i,this.controller=new et(this.model)}var e,o;return e=t,(o=[{key:"init",value:function(){this.controller.initGame()}}])&&rt(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}())).init()})();